import React, { useState, useEffect, useRef } from 'react';
import './App.css';
const API = 'http://localhost:8007';
function App() {
const [view, setView] = useState('datasets');
const [datasets, setDatasets] = useState([]);
const [algorithms, setAlgorithms] = useState([]);
const [runs, setRuns] = useState([]);
const [activity, setActivity] = useState([]);
const [config, setConfig] = useState({});
const [stats, setStats] = useState({});
const [ws, setWs] = useState(null);
const [connected, setConnected] = useState(false);
const [selectedDataset, setSelectedDataset] = useState(null);
const [selectedAlgorithm, setSelectedAlgorithm] = useState(null);
const [selectedRun, setSelectedRun] = useState(null);
const [filterStatus, setFilterStatus] = useState('all');
const [filterFormat, setFilterFormat] = useState('all');
const [filterTag, setFilterTag] = useState('');
const [sortBy, setSortBy] = useState('updated');
const [sortOrder, setSortOrder] = useState('desc');
const [searchQuery, setSearchQuery] = useState('');
const [notifications, setNotifications] = useState([]);
const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
const [theme, setTheme] = useState('light');
const [showActivity, setShowActivity] = useState(false);
const [showConfig, setShowConfig] = useState(false);
const [loading, setLoading] = useState({});
const clientId = useRef(`client_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`);
useEffect(() => { loadData(); connectWebSocket(); const interval = setInterval(() => { loadData(); loadActivity(); }, 5000); return () => { clearInterval(interval); if (ws) ws.close(); }; }, []);
const connectWebSocket = () => { const socket = new WebSocket(`ws://localhost:8007/ws/${clientId.current}`); socket.onopen = () => { setConnected(true); addNotification('connected to server', 'success'); socket.send(JSON.stringify({ type: 'subscribe', channels: ['datasets', 'algorithms', 'runs', 'activity'] })); }; socket.onclose = () => { setConnected(false); addNotification('disconnected from server', 'warning'); setTimeout(connectWebSocket, 3000); }; socket.onmessage = (e) => { const data = JSON.parse(e.data); if (data.type === 'created' || data.type === 'updated' || data.type === 'deleted') { loadData(); addNotification(`${data.resource_type} ${data.type}`, 'info'); } if (data.type === 'progress') { setLoading(prev => ({ ...prev, [data.resource_id]: data.progress })); } if (data.type === 'activity') { setActivity(prev => [data.data, ...prev.slice(0, 99)]); } }; setWs(socket); };
const loadData = async () => { const statusParam = filterStatus !== 'all' ? `status=${filterStatus}` : ''; const formatParam = filterFormat !== 'all' ? `format=${filterFormat}` : ''; const tagParam = filterTag ? `tag=${filterTag}` : ''; const searchParam = searchQuery ? `search=${searchQuery}` : ''; const sortParam = `sort=${sortBy}`; const orderParam = `order=${sortOrder}`; const dsQuery = [statusParam, formatParam, tagParam, searchParam, sortParam, orderParam].filter(p => p).join('&'); const algQuery = [tagParam, searchParam, sortParam, orderParam].filter(p => p).join('&'); const runQuery = [statusParam, searchParam, sortParam, orderParam].filter(p => p).join('&'); const [ds, alg, rn, st] = await Promise.all([fetch(`${API}/api/datasets?${dsQuery}`).then(r => r.json()).catch(() => ({ datasets: [] })), fetch(`${API}/api/algorithms?${algQuery}`).then(r => r.json()).catch(() => ({ algorithms: [] })), fetch(`${API}/api/runs?${runQuery}`).then(r => r.json()).catch(() => ({ runs: [] })), fetch(`${API}/api/stats`).then(r => r.json()).catch(() => ({}))]); setDatasets(ds.datasets || []); setAlgorithms(alg.algorithms || []); setRuns(rn.runs || []); setStats(st); };
const loadActivity = async () => { const res = await fetch(`${API}/api/activity?limit=50`).then(r => r.json()).catch(() => ({ log: [] })); setActivity(res.log || []); };
const loadConfig = async () => { const res = await fetch(`${API}/api/config`).then(r => r.json()).catch(() => ({})); setConfig(res); };
const addNotification = (message, type = 'info') => { const id = Date.now(); setNotifications(prev => [...prev, { id, message, type, time: new Date().toLocaleTimeString() }]); setTimeout(() => setNotifications(prev => prev.filter(n => n.id !== id)), 5000); };
useEffect(() => { if (showConfig) loadConfig(); }, [showConfig]);
useEffect(() => { if (showActivity) loadActivity(); }, [showActivity]);
return (<div className={`app theme-${theme}`}><aside className={`sidebar ${sidebarCollapsed ? 'collapsed' : ''}`}><div className="sidebar-header"><div className="brand"><div className="brand-logo">OS</div><div className="brand-info"><h1>openslam</h1><span className="version">v2.0</span></div></div><button className="sidebar-toggle" onClick={() => setSidebarCollapsed(!sidebarCollapsed)}>{sidebarCollapsed ? '‚Üí' : '‚Üê'}</button></div><div className="sidebar-status"><div className={`connection-status ${connected ? 'connected' : 'disconnected'}`}><span className="status-dot"></span><span className="status-text">{connected ? 'connected' : 'disconnected'}</span></div><div className="system-stats"><div className="stat-item"><span className="stat-label">datasets</span><span className="stat-value">{stats.total_datasets || datasets.length}</span></div><div className="stat-item"><span className="stat-label">algorithms</span><span className="stat-value">{stats.total_algorithms || algorithms.length}</span></div><div className="stat-item"><span className="stat-label">runs</span><span className="stat-value">{stats.total_runs || runs.length}</span></div><div className="stat-item"><span className="stat-label">success rate</span><span className="stat-value">{stats.success_rate ? `${stats.success_rate}%` : 'n/a'}</span></div></div></div><nav className="sidebar-nav"><button className={view === 'datasets' ? 'active' : ''} onClick={() => setView('datasets')}><span className="nav-icon">üìä</span><span className="nav-label">datasets</span><span className="nav-badge">{datasets.length}</span></button><button className={view === 'algorithms' ? 'active' : ''} onClick={() => setView('algorithms')}><span className="nav-icon">üîß</span><span className="nav-label">algorithms</span><span className="nav-badge">{algorithms.length}</span></button><button className={view === 'runs' ? 'active' : ''} onClick={() => setView('runs')}><span className="nav-icon">‚ñ∂Ô∏è</span><span className="nav-label">runs</span><span className="nav-badge">{runs.filter(r => r.status === 'running').length || runs.length}</span></button><button className={view === 'results' ? 'active' : ''} onClick={() => setView('results')}><span className="nav-icon">üìà</span><span className="nav-label">results</span><span className="nav-badge">{runs.filter(r => r.status === 'completed').length}</span></button><button className={view === 'compare' ? 'active' : ''} onClick={() => setView('compare')}><span className="nav-icon">‚öñÔ∏è</span><span className="nav-label">compare</span></button><button className={view === 'analytics' ? 'active' : ''} onClick={() => setView('analytics')}><span className="nav-icon">üìâ</span><span className="nav-label">analytics</span></button></nav><div className="sidebar-footer"><button className="action-btn" onClick={() => { setShowActivity(!showActivity); if (!showActivity) loadActivity(); }}><span className="btn-icon">üìã</span><span className="btn-label">activity log</span></button><button className="action-btn" onClick={() => { setShowConfig(!showConfig); if (!showConfig) loadConfig(); }}><span className="btn-icon">‚öôÔ∏è</span><span className="btn-label">configuration</span></button><button className="theme-toggle" onClick={() => setTheme(theme === 'light' ? 'dark' : 'light')}><span className="theme-icon">{theme === 'light' ? 'üåô' : '‚òÄÔ∏è'}</span><span className="theme-label">{theme === 'light' ? 'dark' : 'light'} mode</span></button><div className="footer-info"><p className="footer-text">research-grade slam evaluation platform</p></div></div></aside><main className={`main-content ${sidebarCollapsed ? 'expanded' : ''}`}><div className="content-header"><div className="header-left"><h2 className="view-title">{view}</h2><p className="view-description">{view === 'datasets' && 'manage and process slam datasets with path-based loading'}{view === 'algorithms' && 'create and configure slam algorithms with custom implementations'}{view === 'runs' && 'execute and monitor slam evaluations with real-time progress'}{view === 'results' && 'analyze and compare slam performance with comprehensive metrics'}{view === 'compare' && 'statistical comparison of multiple runs with rankings'}{view === 'analytics' && 'advanced analytics and insights with predictive features'}</p></div><div className="header-actions"><div className="search-box"><input type="text" placeholder="search..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} onKeyPress={(e) => e.key === 'Enter' && loadData()} className="search-input" /><button className="search-btn" onClick={loadData}>üîç</button></div><div className="filter-controls">{(view === 'datasets' || view === 'runs') && (<select value={filterStatus} onChange={(e) => { setFilterStatus(e.target.value); setTimeout(loadData, 100); }} className="filter-select"><option value="all">all status</option><option value="uploaded">uploaded</option><option value="processing">processing</option><option value="processed">processed</option><option value="pending">pending</option><option value="running">running</option><option value="completed">completed</option><option value="failed">failed</option></select>)}{view === 'datasets' && (<select value={filterFormat} onChange={(e) => { setFilterFormat(e.target.value); setTimeout(loadData, 100); }} className="filter-select"><option value="all">all formats</option><option value="kitti">kitti</option><option value="euroc">euroc</option><option value="tum">tum</option><option value="rosbag">rosbag</option><option value="custom">custom</option></select>)}<select value={sortBy} onChange={(e) => { setSortBy(e.target.value); setTimeout(loadData, 100); }} className="filter-select"><option value="updated">updated</option><option value="created">created</option><option value="name">name</option></select><button className="sort-order-btn" onClick={() => { setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc'); setTimeout(loadData, 100); }}>{sortOrder === 'asc' ? '‚Üë' : '‚Üì'}</button></div></div></div><div className="content-body">{view === 'datasets' && <Datasets datasets={datasets} onUpdate={loadData} onSelect={setSelectedDataset} selected={selectedDataset} addNotification={addNotification} loading={loading} />}{view === 'algorithms' && <Algorithms algorithms={algorithms} onUpdate={loadData} onSelect={setSelectedAlgorithm} selected={selectedAlgorithm} addNotification={addNotification} />}{view === 'runs' && <Runs runs={runs} datasets={datasets.filter(d => d.status === 'processed')} algorithms={algorithms} onUpdate={loadData} addNotification={addNotification} loading={loading} />}{view === 'results' && <Results runs={runs.filter(r => r.status === 'completed')} onSelect={setSelectedRun} selected={selectedRun} addNotification={addNotification} />}{view === 'compare' && <Compare runs={runs.filter(r => r.status === 'completed')} addNotification={addNotification} />}{view === 'analytics' && <Analytics runs={runs} datasets={datasets} algorithms={algorithms} stats={stats} addNotification={addNotification} />}</div></main>{showActivity && <ActivityPanel activity={activity} onClose={() => setShowActivity(false)} theme={theme} />}{showConfig && <ConfigPanel config={config} onClose={() => setShowConfig(false)} onSave={(newConfig) => { fetch(`${API}/api/config`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(newConfig) }).then(() => { addNotification('configuration updated', 'success'); setShowConfig(false); loadConfig(); }).catch(() => addNotification('failed to update config', 'error')); }} theme={theme} />}<div className="notifications-container">{notifications.map(n => (<div key={n.id} className={`notification notification-${n.type}`}><div className="notification-content"><span className="notification-icon">{n.type === 'success' ? '‚úì' : n.type === 'error' ? '‚úó' : n.type === 'warning' ? '‚ö†' : '‚Ñπ'}</span><span className="notification-message">{n.message}</span></div><span className="notification-time">{n.time}</span></div>))}</div></div>);
}
function ActivityPanel({ activity, onClose, theme }) {
return (<div className="side-panel side-panel-right" onClick={onClose}><div className="side-panel-content" onClick={(e) => e.stopPropagation()}><div className="side-panel-header"><h2>activity log</h2><button className="panel-close" onClick={onClose}>√ó</button></div><div className="side-panel-body">{activity.length === 0 ? (<div className="empty-state-small"><p>no recent activity</p></div>) : (<div className="activity-timeline">{activity.map(act => (<div key={act.id} className="timeline-item"><div className="timeline-marker"></div><div className="timeline-content"><div className="timeline-header"><span className="timeline-action">{act.action}</span><span className="timeline-resource">{act.resource_type}</span><span className="timeline-time">{new Date(act.timestamp).toLocaleTimeString()}</span></div><div className="timeline-id">{act.resource_id}</div>{act.details && Object.keys(act.details).length > 0 && (<div className="timeline-details">{Object.entries(act.details).map(([k, v]) => (<span key={k} className="detail-tag">{k}: {JSON.stringify(v)}</span>))}</div>)}</div></div>))}</div>)}</div></div></div>);
}
function ConfigPanel({ config, onClose, onSave, theme }) {
const [editConfig, setEditConfig] = useState(JSON.stringify(config, null, 2));
return (<div className="side-panel side-panel-right" onClick={onClose}><div className="side-panel-content side-panel-wide" onClick={(e) => e.stopPropagation()}><div className="side-panel-header"><h2>system configuration</h2><button className="panel-close" onClick={onClose}>√ó</button></div><div className="side-panel-body"><div className="config-editor"><label className="form-label">configuration (json)</label><textarea className="form-textarea code-editor" rows={20} value={editConfig} onChange={(e) => setEditConfig(e.target.value)} /></div></div><div className="side-panel-footer"><button className="btn btn-ghost" onClick={onClose}>cancel</button><button className="btn btn-primary" onClick={() => { try { const parsed = JSON.parse(editConfig); onSave(parsed); } catch { alert('invalid json'); } }}>save configuration</button></div></div></div>);
}
function Datasets({ datasets, onUpdate, onSelect, selected, addNotification, loading }) {
const [showPathModal, setShowPathModal] = useState(false);
const [showEditModal, setShowEditModal] = useState(false);
const [editingDataset, setEditingDataset] = useState(null);
const [datasetPath, setDatasetPath] = useState('');
const [datasetName, setDatasetName] = useState('');
const [datasetDescription, setDatasetDescription] = useState('');
const [datasetTags, setDatasetTags] = useState('');
const [loadingState, setLoadingState] = useState(false);
const [showDetails, setShowDetails] = useState({});
const [processing, setProcessing] = useState({});
const [previewData, setPreviewData] = useState({});
const [statsData, setStatsData] = useState({});
const handleAddDataset = async () => { if (!datasetPath || !datasetName) { addNotification('path and name required', 'error'); return; } setLoadingState(true); const tags = datasetTags.split(',').map(t => t.trim()).filter(t => t); const res = await fetch(`${API}/api/dataset/load`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ path: datasetPath, name: datasetName, description: datasetDescription, tags }) }).catch(() => null); setLoadingState(false); if (res && res.ok) { addNotification(`dataset ${datasetName} added`, 'success'); setShowPathModal(false); setDatasetPath(''); setDatasetName(''); setDatasetDescription(''); setDatasetTags(''); onUpdate(); } else { const err = await res.json().catch(() => ({ detail: 'unknown error' })); addNotification(err.detail || 'failed to add dataset', 'error'); } };
const handleUpdateDataset = async () => { if (!editingDataset) return; const tags = datasetTags.split(',').map(t => t.trim()).filter(t => t); const updates = {}; if (datasetName !== editingDataset.name) updates.name = datasetName; if (datasetDescription !== editingDataset.description) updates.description = datasetDescription; if (JSON.stringify(tags) !== JSON.stringify(editingDataset.tags || [])) updates.tags = tags; if (Object.keys(updates).length === 0) { addNotification('no changes made', 'warning'); return; } setLoadingState(true); const res = await fetch(`${API}/api/dataset/${editingDataset.id}`, { method: 'PATCH', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(updates) }).catch(() => null); setLoadingState(false); if (res && res.ok) { addNotification('dataset updated', 'success'); setShowEditModal(false); setEditingDataset(null); onUpdate(); } else { addNotification('failed to update dataset', 'error'); } };
const handleProcess = async (id) => { setProcessing({ ...processing, [id]: true }); const res = await fetch(`${API}/api/dataset/${id}/process`, { method: 'POST' }).catch(() => null); if (res && res.ok) { addNotification('dataset processing started', 'success'); onUpdate(); } else { addNotification('failed to process dataset', 'error'); } setProcessing({ ...processing, [id]: false }); };
const handleDelete = async (id, name) => { if (!window.confirm(`delete dataset ${name}?`)) return; const res = await fetch(`${API}/api/dataset/${id}`, { method: 'DELETE' }).catch(() => null); if (res && res.ok) { addNotification('dataset deleted', 'success'); onUpdate(); } else { addNotification('failed to delete dataset', 'error'); } };
const loadPreview = async (id) => { if (previewData[id]) return; const res = await fetch(`${API}/api/dataset/${id}/preview`).then(r => r.json()).catch(() => null); if (res) setPreviewData({ ...previewData, [id]: res }); };
const loadStats = async (id) => { if (statsData[id]) return; const res = await fetch(`${API}/api/dataset/${id}/statistics`).then(r => r.json()).catch(() => null); if (res) setStatsData({ ...statsData, [id]: res }); };
const toggleDetails = (id) => { const newState = !showDetails[id]; setShowDetails({ ...showDetails, [id]: newState }); if (newState) { loadPreview(id); loadStats(id); } };
const openEditModal = (ds) => { setEditingDataset(ds); setDatasetName(ds.name || ''); setDatasetDescription(ds.description || ''); setDatasetTags((ds.tags || []).join(', ')); setShowEditModal(true); };
return (<div className="datasets-view"><div className="view-actions"><button className="btn btn-primary" onClick={() => setShowPathModal(true)}><span className="btn-icon">+</span>add dataset</button><div className="view-stats"><div className="stat-pill"><span className="stat-pill-label">total</span><span className="stat-pill-value">{datasets.length}</span></div><div className="stat-pill stat-pill-success"><span className="stat-pill-label">processed</span><span className="stat-pill-value">{datasets.filter(d => d.status === 'processed').length}</span></div><div className="stat-pill stat-pill-warning"><span className="stat-pill-label">processing</span><span className="stat-pill-value">{datasets.filter(d => d.status === 'processing').length}</span></div><div className="stat-pill stat-pill-info"><span className="stat-pill-label">uploaded</span><span className="stat-pill-value">{datasets.filter(d => d.status === 'uploaded').length}</span></div></div></div>{datasets.length === 0 ? (<div className="empty-state"><div className="empty-icon">üìä</div><h3>no datasets found</h3><p>add a dataset by selecting its path on your system</p><button className="btn btn-primary" onClick={() => setShowPathModal(true)}>add first dataset</button></div>) : (<div className="items-grid">{datasets.map(ds => (<div key={ds.id} className={`dataset-card ${selected?.id === ds.id ? 'selected' : ''}`} onClick={() => onSelect(ds)}><div className="card-header"><div className="card-title-row"><h3 className="card-title">{ds.name || ds.id}</h3><div className="card-badges"><span className={`badge badge-${ds.status || 'unknown'}`}>{ds.status || 'unknown'}</span>{ds.format && <span className="badge badge-format">{ds.format}</span>}</div></div><button className="card-action-btn" onClick={(e) => { e.stopPropagation(); toggleDetails(ds.id); }}>{showDetails[ds.id] ? '‚ñ≤' : '‚ñº'}</button></div><div className="card-body">{ds.description && <p className="card-description">{ds.description}</p>}{ds.tags && ds.tags.length > 0 && (<div className="tags-container">{ds.tags.map(tag => (<span key={tag} className="tag">{tag}</span>))}</div>)}<div className="card-info-grid"><div className="info-item"><span className="info-label">path</span><span className="info-value" title={ds.path}>{ds.path ? ds.path.split('/').slice(-2).join('/') : 'n/a'}</span></div>{ds.frames > 0 && <div className="info-item"><span className="info-label">frames</span><span className="info-value">{ds.frames}</span></div>}{ds.sequences > 0 && <div className="info-item"><span className="info-label">sequences</span><span className="info-value">{ds.sequences}</span></div>}{ds.file_count > 0 && <div className="info-item"><span className="info-label">files</span><span className="info-value">{ds.file_count}</span></div>}{ds.size && <div className="info-item"><span className="info-label">size</span><span className="info-value">{formatBytes(ds.size)}</span></div>}{ds.ground_truth !== undefined && <div className="info-item"><span className="info-label">ground truth</span><span className="info-value">{ds.ground_truth ? '‚úì' : '‚úó'}</span></div>}</div>{loading[ds.id] && (<div className="progress-bar-small"><div className="progress-fill-small" style={{ width: `${loading[ds.id]}%` }}></div><span className="progress-text-small">{loading[ds.id]}%</span></div>)}{showDetails[ds.id] && (<div className="card-details"><div className="details-section"><h4>dataset information</h4><div className="details-grid"><p><strong>id:</strong> {ds.id}</p><p><strong>created:</strong> {ds.created ? new Date(ds.created).toLocaleString() : 'n/a'}</p><p><strong>updated:</strong> {ds.updated ? new Date(ds.updated).toLocaleString() : 'n/a'}</p><p><strong>checksum:</strong> {ds.checksum || 'n/a'}</p>{ds.sensors && ds.sensors.length > 0 && (<div className="sensors-list"><strong>sensors:</strong> {ds.sensors.join(', ')}</div>)}{ds.errors && ds.errors.length > 0 && (<div className="errors-section"><h5>validation errors</h5>{ds.errors.map((err, idx) => (<p key={idx} className="error-text">{err}</p>))}</div>)}</div></div>{previewData[ds.id] && (<div className="details-section"><h4>dataset preview</h4><pre className="code-block">{JSON.stringify(previewData[ds.id], null, 2)}</pre></div>)}{statsData[ds.id] && (<div className="details-section"><h4>statistics</h4><div className="stats-grid">{Object.entries(statsData[ds.id]).map(([k, v]) => (<div key={k} className="stat-card-small"><span className="stat-label-small">{k}</span><span className="stat-value-small">{typeof v === 'number' ? v.toFixed(2) : JSON.stringify(v)}</span></div>))}</div></div>)}</div>)}</div><div className="card-footer"><div className="card-actions">{ds.status === 'uploaded' && (<button className="btn btn-sm btn-primary" onClick={(e) => { e.stopPropagation(); handleProcess(ds.id); }} disabled={processing[ds.id]}>{processing[ds.id] ? 'processing...' : 'process'}</button>)}{ds.status === 'processed' && (<button className="btn btn-sm btn-success" disabled><span className="btn-icon">‚úì</span>ready</button>)}<button className="btn btn-sm btn-secondary" onClick={(e) => { e.stopPropagation(); openEditModal(ds); }}>edit</button><button className="btn btn-sm btn-ghost" onClick={(e) => { e.stopPropagation(); handleDelete(ds.id, ds.name); }}>delete</button></div></div></div>))}</div>)}{showPathModal && (<div className="modal" onClick={() => setShowPathModal(false)}><div className="modal-content modal-large" onClick={(e) => e.stopPropagation()}><div className="modal-header"><h2>add dataset</h2><button className="modal-close" onClick={() => setShowPathModal(false)}>√ó</button></div><div className="modal-body"><div className="form-group"><label className="form-label">dataset name *</label><input type="text" className="form-input" placeholder="my slam dataset" value={datasetName} onChange={(e) => setDatasetName(e.target.value)} /></div><div className="form-group"><label className="form-label">dataset path *</label><div className="path-input-group"><input type="text" className="form-input" placeholder="/absolute/path/to/dataset" value={datasetPath} onChange={(e) => setDatasetPath(e.target.value)} /></div><p className="form-help">enter the absolute path to your slam dataset directory (path-based loading, no files copied)</p></div><div className="form-group"><label className="form-label">description</label><input type="text" className="form-input" placeholder="dataset description" value={datasetDescription} onChange={(e) => setDatasetDescription(e.target.value)} /></div><div className="form-group"><label className="form-label">tags (comma-separated)</label><input type="text" className="form-input" placeholder="indoor, visual-inertial, night" value={datasetTags} onChange={(e) => setDatasetTags(e.target.value)} /></div><div className="info-box"><h4>supported formats</h4><ul className="format-list"><li><strong>kitti:</strong> sequences with poses and calibration files</li><li><strong>euroc:</strong> mav0 format with multi-sensor data</li><li><strong>tum:</strong> rgb-d format with timestamp associations</li><li><strong>rosbag:</strong> ros bag files with sensor topics</li><li><strong>custom:</strong> automatic format detection</li></ul></div></div><div className="modal-footer"><button className="btn btn-ghost" onClick={() => setShowPathModal(false)}>cancel</button><button className="btn btn-primary" onClick={handleAddDataset} disabled={loadingState || !datasetPath || !datasetName}>{loadingState ? 'adding...' : 'add dataset'}</button></div></div></div>)}{showEditModal && editingDataset && (<div className="modal" onClick={() => setShowEditModal(false)}><div className="modal-content modal-large" onClick={(e) => e.stopPropagation()}><div className="modal-header"><h2>edit dataset</h2><button className="modal-close" onClick={() => setShowEditModal(false)}>√ó</button></div><div className="modal-body"><div className="form-group"><label className="form-label">dataset name</label><input type="text" className="form-input" value={datasetName} onChange={(e) => setDatasetName(e.target.value)} /></div><div className="form-group"><label className="form-label">description</label><input type="text" className="form-input" value={datasetDescription} onChange={(e) => setDatasetDescription(e.target.value)} /></div><div className="form-group"><label className="form-label">tags (comma-separated)</label><input type="text" className="form-input" value={datasetTags} onChange={(e) => setDatasetTags(e.target.value)} /></div></div><div className="modal-footer"><button className="btn btn-ghost" onClick={() => setShowEditModal(false)}>cancel</button><button className="btn btn-primary" onClick={handleUpdateDataset} disabled={loadingState}>{loadingState ? 'updating...' : 'update dataset'}</button></div></div></div>)}</div>);
}
function Algorithms({ algorithms, onUpdate, onSelect, selected, addNotification }) {
const [showModal, setShowModal] = useState(false);
const [showEditModal, setShowEditModal] = useState(false);
const [showTemplatesModal, setShowTemplatesModal] = useState(false);
const [editingAlgorithm, setEditingAlgorithm] = useState(null);
const [templates, setTemplates] = useState([]);
const [name, setName] = useState('');
const [description, setDescription] = useState('');
const [algoType, setAlgoType] = useState('custom');
const [tags, setTags] = useState('');
const [code, setCode] = useState('class CustomSLAM:\n    def initialize(self, cfg):\n        pass\n    def process_frame(self, frame_data):\n        return None\n    def finalize(self):\n        return {}');
const [params, setParams] = useState('{}');
const [loading, setLoading] = useState(false);
const [showDetails, setShowDetails] = useState({});
const loadTemplates = async () => { const res = await fetch(`${API}/api/algorithm/templates`).then(r => r.json()).catch(() => ({ templates: [] })); setTemplates(res.templates || []); setShowTemplatesModal(true); };
const handleCreate = async () => { if (!name) { addNotification('algorithm name required', 'error'); return; } let parsedParams = {}; if (params) { try { parsedParams = JSON.parse(params); } catch { addNotification('invalid json parameters', 'error'); return; } } const tagList = tags.split(',').map(t => t.trim()).filter(t => t); setLoading(true); const res = await fetch(`${API}/api/algorithm`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ name, description, type: algoType, code, params: parsedParams, tags: tagList }) }).catch(() => null); setLoading(false); if (res && res.ok) { addNotification(`algorithm ${name} created`, 'success'); setShowModal(false); setName(''); setDescription(''); setAlgoType('custom'); setCode('class CustomSLAM:\n    def initialize(self, cfg):\n        pass\n    def process_frame(self, frame_data):\n        return None\n    def finalize(self):\n        return {}'); setParams('{}'); setTags(''); onUpdate(); } else { addNotification('failed to create algorithm', 'error'); } };
const handleUpdate = async () => { if (!editingAlgorithm) return; const tagList = tags.split(',').map(t => t.trim()).filter(t => t); const updates = {}; if (name !== editingAlgorithm.name) updates.name = name; if (description !== editingAlgorithm.description) updates.description = description; if (JSON.stringify(tagList) !== JSON.stringify(editingAlgorithm.tags || [])) updates.tags = tagList; if (Object.keys(updates).length === 0) { addNotification('no changes made', 'warning'); return; } setLoading(true); const res = await fetch(`${API}/api/algorithm/${editingAlgorithm.id}`, { method: 'PATCH', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(updates) }).catch(() => null); setLoading(false); if (res && res.ok) { addNotification('algorithm updated', 'success'); setShowEditModal(false); setEditingAlgorithm(null); onUpdate(); } else { addNotification('failed to update algorithm', 'error'); } };
const handleDelete = async (id, name) => { if (!window.confirm(`delete algorithm ${name}?`)) return; const res = await fetch(`${API}/api/algorithm/${id}`, { method: 'DELETE' }).catch(() => null); if (res && res.ok) { addNotification('algorithm deleted', 'success'); onUpdate(); } else { addNotification('failed to delete algorithm', 'error'); } };
const toggleDetails = (id) => { setShowDetails({ ...showDetails, [id]: !showDetails[id] }); };
const openEditModal = (alg) => { setEditingAlgorithm(alg); setName(alg.name || ''); setDescription(alg.description || ''); setTags((alg.tags || []).join(', ')); setShowEditModal(true); };
const useTemplate = (template) => { setCode(template.code); setParams(JSON.stringify(template.params, null, 2)); setDescription(template.description); setShowTemplatesModal(false); addNotification(`template ${template.name} loaded`, 'success'); };
return (<div className="algorithms-view"><div className="view-actions"><button className="btn btn-primary" onClick={() => setShowModal(true)}><span className="btn-icon">+</span>create algorithm</button><button className="btn btn-secondary" onClick={loadTemplates}><span className="btn-icon">üìã</span>templates</button><div className="view-stats"><div className="stat-pill"><span className="stat-pill-label">total</span><span className="stat-pill-value">{algorithms.length}</span></div><div className="stat-pill stat-pill-info"><span className="stat-pill-label">custom</span><span className="stat-pill-value">{algorithms.filter(a => a.type === 'custom').length}</span></div><div className="stat-pill stat-pill-success"><span className="stat-pill-label">builtin</span><span className="stat-pill-value">{algorithms.filter(a => a.type === 'builtin').length}</span></div></div></div>{algorithms.length === 0 ? (<div className="empty-state"><div className="empty-icon">üîß</div><h3>no algorithms found</h3><p>create a custom slam algorithm or use a template to get started</p><button className="btn btn-primary" onClick={() => setShowModal(true)}>create first algorithm</button></div>) : (<div className="items-grid">{algorithms.map(alg => (<div key={alg.id} className={`algorithm-card ${selected?.id === alg.id ? 'selected' : ''}`} onClick={() => onSelect(alg)}><div className="card-header"><div className="card-title-row"><h3 className="card-title">{alg.name || alg.id}</h3><div className="card-badges"><span className={`badge badge-${alg.type || 'custom'}`}>{alg.type || 'custom'}</span></div></div><button className="card-action-btn" onClick={(e) => { e.stopPropagation(); toggleDetails(alg.id); }}>{showDetails[alg.id] ? '‚ñ≤' : '‚ñº'}</button></div><div className="card-body">{alg.description && <p className="card-description">{alg.description}</p>}{alg.tags && alg.tags.length > 0 && (<div className="tags-container">{alg.tags.map(tag => (<span key={tag} className="tag">{tag}</span>))}</div>)}<div className="card-info-grid"><div className="info-item"><span className="info-label">created</span><span className="info-value">{alg.created ? new Date(alg.created).toLocaleString() : 'n/a'}</span></div><div className="info-item"><span className="info-label">parameters</span><span className="info-value">{alg.params ? Object.keys(alg.params).length : 0}</span></div></div>{showDetails[alg.id] && (<div className="card-details"><div className="details-section"><h4>algorithm configuration</h4><div className="details-grid"><p><strong>id:</strong> {alg.id}</p><p><strong>type:</strong> {alg.type || 'custom'}</p><p><strong>updated:</strong> {alg.updated ? new Date(alg.updated).toLocaleString() : 'n/a'}</p>{alg.params && Object.keys(alg.params).length > 0 && (<div className="params-section"><h5>parameters</h5><pre className="code-block">{JSON.stringify(alg.params, null, 2)}</pre></div>)}{alg.code && (<div className="code-section"><h5>implementation</h5><pre className="code-block">{alg.code.substring(0, 800)}{alg.code.length > 800 ? '...' : ''}</pre></div>)}</div></div></div>)}</div><div className="card-footer"><div className="card-actions"><button className="btn btn-sm btn-secondary" onClick={(e) => { e.stopPropagation(); openEditModal(alg); }}>edit</button><button className="btn btn-sm btn-ghost" onClick={(e) => { e.stopPropagation(); handleDelete(alg.id, alg.name); }}>delete</button></div></div></div>))}</div>)}{showModal && (<div className="modal" onClick={() => setShowModal(false)}><div className="modal-content modal-xlarge" onClick={(e) => e.stopPropagation()}><div className="modal-header"><h2>create algorithm</h2><button className="modal-close" onClick={() => setShowModal(false)}>√ó</button></div><div className="modal-body"><div className="form-grid"><div className="form-group"><label className="form-label">algorithm name *</label><input type="text" className="form-input" placeholder="my slam algorithm" value={name} onChange={(e) => setName(e.target.value)} /></div><div className="form-group"><label className="form-label">type</label><select className="form-select" value={algoType} onChange={(e) => setAlgoType(e.target.value)}><option value="custom">custom</option><option value="builtin">builtin</option><option value="visual">visual</option><option value="lidar">lidar</option><option value="visual-inertial">visual-inertial</option></select></div></div><div className="form-group"><label className="form-label">description</label><input type="text" className="form-input" placeholder="describe your algorithm" value={description} onChange={(e) => setDescription(e.target.value)} /></div><div className="form-group"><label className="form-label">tags (comma-separated)</label><input type="text" className="form-input" placeholder="monocular, feature-based, real-time" value={tags} onChange={(e) => setTags(e.target.value)} /></div><div className="form-group"><label className="form-label">implementation code</label><textarea className="form-textarea code-editor" rows={15} value={code} onChange={(e) => setCode(e.target.value)} placeholder="implement your slam algorithm" /></div><div className="form-group"><label className="form-label">parameters (json)</label><textarea className="form-textarea" rows={4} value={params} onChange={(e) => setParams(e.target.value)} placeholder='{"param1": "value1"}' /></div><div className="info-box"><h4>implementation requirements</h4><ul className="format-list"><li><strong>initialize(cfg):</strong> setup algorithm with configuration</li><li><strong>process_frame(frame_data):</strong> process single frame, return pose estimate</li><li><strong>finalize():</strong> cleanup and return complete trajectory dictionary</li></ul></div></div><div className="modal-footer"><button className="btn btn-ghost" onClick={() => setShowModal(false)}>cancel</button><button className="btn btn-secondary" onClick={loadTemplates}>load template</button><button className="btn btn-primary" onClick={handleCreate} disabled={loading || !name}>{loading ? 'creating...' : 'create algorithm'}</button></div></div></div>)}{showEditModal && editingAlgorithm && (<div className="modal" onClick={() => setShowEditModal(false)}><div className="modal-content modal-large" onClick={(e) => e.stopPropagation()}><div className="modal-header"><h2>edit algorithm</h2><button className="modal-close" onClick={() => setShowEditModal(false)}>√ó</button></div><div className="modal-body"><div className="form-group"><label className="form-label">algorithm name</label><input type="text" className="form-input" value={name} onChange={(e) => setName(e.target.value)} /></div><div className="form-group"><label className="form-label">description</label><input type="text" className="form-input" value={description} onChange={(e) => setDescription(e.target.value)} /></div><div className="form-group"><label className="form-label">tags (comma-separated)</label><input type="text" className="form-input" value={tags} onChange={(e) => setTags(e.target.value)} /></div></div><div className="modal-footer"><button className="btn btn-ghost" onClick={() => setShowEditModal(false)}>cancel</button><button className="btn btn-primary" onClick={handleUpdate} disabled={loading}>{loading ? 'updating...' : 'update algorithm'}</button></div></div></div>)}{showTemplatesModal && (<div className="modal" onClick={() => setShowTemplatesModal(false)}><div className="modal-content modal-large" onClick={(e) => e.stopPropagation()}><div className="modal-header"><h2>algorithm templates</h2><button className="modal-close" onClick={() => setShowTemplatesModal(false)}>√ó</button></div><div className="modal-body">{templates.length === 0 ? (<p>no templates available</p>) : (<div className="templates-grid">{templates.map((tpl, idx) => (<div key={idx} className="template-card" onClick={() => useTemplate(tpl)}><h4>{tpl.name}</h4><p>{tpl.description}</p><div className="template-meta"><span className="badge badge-custom">{tpl.type}</span></div></div>))}</div>)}</div><div className="modal-footer"><button className="btn btn-ghost" onClick={() => setShowTemplatesModal(false)}>close</button></div></div></div>)}</div>);
}
function Runs({ runs, datasets, algorithms, onUpdate, addNotification, loading }) {
const [selectedDataset, setSelectedDataset] = useState('');
const [selectedAlgorithm, setSelectedAlgorithm] = useState('');
const [priority, setPriority] = useState('normal');
const [taskType, setTaskType] = useState('evaluation');
const [loadingState, setLoadingState] = useState(false);
const [showDetails, setShowDetails] = useState({});
const [cancelling, setCancelling] = useState({});
const handleRun = async () => { if (!selectedDataset || !selectedAlgorithm) { addNotification('select dataset and algorithm', 'error'); return; } setLoadingState(true); const res = await fetch(`${API}/api/run`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ dataset_id: selectedDataset, algorithm_id: selectedAlgorithm, priority, task_type: taskType }) }).catch(() => null); setLoadingState(false); if (res && res.ok) { addNotification('run started', 'success'); setSelectedDataset(''); setSelectedAlgorithm(''); onUpdate(); } else { addNotification('failed to start run', 'error'); } };
const handleCancel = async (id) => { setCancelling({ ...cancelling, [id]: true }); const res = await fetch(`${API}/api/run/${id}/cancel`, { method: 'POST' }).catch(() => null); if (res && res.ok) { addNotification('run cancelled', 'success'); onUpdate(); } else { addNotification('failed to cancel run', 'error'); } setCancelling({ ...cancelling, [id]: false }); };
const handleDelete = async (id) => { if (!window.confirm('delete this run?')) return; const res = await fetch(`${API}/api/run/${id}`, { method: 'DELETE' }).catch(() => null); if (res && res.ok) { addNotification('run deleted', 'success'); onUpdate(); } else { addNotification('failed to delete run', 'error'); } };
const toggleDetails = (id) => { setShowDetails({ ...showDetails, [id]: !showDetails[id] }); };
const getStatusIcon = (status) => { switch(status) { case 'running': return '‚ñ∂Ô∏è'; case 'completed': return '‚úì'; case 'failed': return '‚úó'; case 'cancelled': return '‚äó'; default: return '‚óã'; } };
const getProgressPercentage = (run) => { if (run.status === 'completed') return 100; if (run.status === 'failed' || run.status === 'cancelled') return 0; if (loading[run.id]) return loading[run.id]; if (run.progress) return run.progress; return 0; };
return (<div className="runs-view"><div className="run-control-panel"><h3>execute slam evaluation</h3><div className="control-form"><div className="form-row"><div className="form-group"><label className="form-label">select dataset *</label><select className="form-select" value={selectedDataset} onChange={(e) => setSelectedDataset(e.target.value)}><option value="">choose dataset</option>{datasets.map(ds => (<option key={ds.id} value={ds.id}>{ds.name || ds.id} ({ds.format})</option>))}</select></div><div className="form-group"><label className="form-label">select algorithm *</label><select className="form-select" value={selectedAlgorithm} onChange={(e) => setSelectedAlgorithm(e.target.value)}><option value="">choose algorithm</option>{algorithms.map(alg => (<option key={alg.id} value={alg.id}>{alg.name || alg.id}</option>))}</select></div><div className="form-group"><label className="form-label">priority</label><select className="form-select" value={priority} onChange={(e) => setPriority(e.target.value)}><option value="low">low</option><option value="normal">normal</option><option value="high">high</option></select></div><div className="form-group"><label className="form-label">task type</label><select className="form-select" value={taskType} onChange={(e) => setTaskType(e.target.value)}><option value="evaluation">evaluation</option><option value="localization">localization</option><option value="mapping">mapping</option><option value="exploration">exploration</option></select></div><div className="form-group"><button className="btn btn-primary btn-large" onClick={handleRun} disabled={loadingState || !selectedDataset || !selectedAlgorithm}><span className="btn-icon">{loadingState ? '‚è≥' : '‚ñ∂Ô∏è'}</span>{loadingState ? 'starting...' : 'start evaluation'}</button></div></div></div></div><div className="runs-list"><div className="runs-header"><h3>evaluation runs</h3><div className="runs-stats"><div className="stat-pill"><span className="stat-pill-label">total</span><span className="stat-pill-value">{runs.length}</span></div><div className="stat-pill stat-pill-warning"><span className="stat-pill-label">running</span><span className="stat-pill-value">{runs.filter(r => r.status === 'running').length}</span></div><div className="stat-pill stat-pill-success"><span className="stat-pill-label">completed</span><span className="stat-pill-value">{runs.filter(r => r.status === 'completed').length}</span></div><div className="stat-pill stat-pill-error"><span className="stat-pill-label">failed</span><span className="stat-pill-value">{runs.filter(r => r.status === 'failed').length}</span></div></div></div>{runs.length === 0 ? (<div className="empty-state"><div className="empty-icon">‚ñ∂Ô∏è</div><h3>no runs found</h3><p>start a slam evaluation run to see results</p></div>) : (<div className="items-list">{runs.map(run => (<div key={run.id} className="run-item"><div className="run-header"><div className="run-title-row"><span className="run-icon">{getStatusIcon(run.status)}</span><h4 className="run-title">{run.id}</h4><span className={`badge badge-${run.status}`}>{run.status}</span>{run.priority && run.priority !== 'normal' && <span className={`badge badge-priority-${run.priority}`}>{run.priority}</span>}{run.task_type && <span className="badge badge-task">{run.task_type}</span>}</div><div className="run-actions-header">{run.status === 'running' && (<button className="btn btn-sm btn-secondary" onClick={() => handleCancel(run.id)} disabled={cancelling[run.id]}>{cancelling[run.id] ? 'cancelling...' : 'cancel'}</button>)}<button className="card-action-btn" onClick={() => toggleDetails(run.id)}>{showDetails[run.id] ? '‚ñ≤' : '‚ñº'}</button></div></div><div className="run-body"><div className="run-info-grid"><div className="info-item"><span className="info-label">dataset</span><span className="info-value">{run.dataset_name || run.dataset_id}</span></div><div className="info-item"><span className="info-label">algorithm</span><span className="info-value">{run.algorithm_name || run.algorithm_id}</span></div><div className="info-item"><span className="info-label">started</span><span className="info-value">{run.timestamp ? new Date(run.timestamp).toLocaleString() : 'n/a'}</span></div>{run.duration && <div className="info-item"><span className="info-label">duration</span><span className="info-value">{run.duration}s</span></div>}</div>{(run.status === 'running' || getProgressPercentage(run) > 0) && (<div className="progress-bar"><div className="progress-fill" style={{ width: `${getProgressPercentage(run)}%` }}></div><span className="progress-text">{getProgressPercentage(run).toFixed(0)}%</span></div>)}{run.metrics && Object.keys(run.metrics).length > 0 && (<div className="metrics-preview"><div className="metrics-row">{Object.entries(run.metrics).slice(0, 6).map(([key, val]) => (<div key={key} className="metric-item"><span className="metric-label">{key}</span><span className="metric-value">{typeof val === 'number' ? val.toFixed(4) : val}</span></div>))}</div></div>)}{showDetails[run.id] && (<div className="run-details"><div className="details-section"><h5>run information</h5><div className="details-grid"><p><strong>run id:</strong> {run.id}</p><p><strong>dataset id:</strong> {run.dataset_id}</p><p><strong>algorithm id:</strong> {run.algorithm_id}</p><p><strong>status:</strong> {run.status}</p><p><strong>priority:</strong> {run.priority || 'normal'}</p><p><strong>task type:</strong> {run.task_type || 'evaluation'}</p>{run.created && <p><strong>created:</strong> {new Date(run.created).toLocaleString()}</p>}{run.updated && <p><strong>updated:</strong> {new Date(run.updated).toLocaleString()}</p>}{run.error && <p className="error-text"><strong>error:</strong> {run.error}</p>}{run.robustness_score !== undefined && <p><strong>robustness score:</strong> {run.robustness_score.toFixed(2)}</p>}{run.task_alignment_score !== undefined && <p><strong>task alignment:</strong> {run.task_alignment_score.toFixed(2)}</p>}{run.metrics && (<div className="full-metrics"><h5>complete metrics</h5><pre className="code-block">{JSON.stringify(run.metrics, null, 2)}</pre></div>)}</div></div></div>)}</div><div className="card-footer"><button className="btn btn-sm btn-ghost" onClick={() => handleDelete(run.id)}>delete</button></div></div>))}</div>)}</div></div>);
}
function Results({ runs, onSelect, selected, addNotification }) {
const [activeTab, setActiveTab] = useState('metrics');
return (<div className="results-view"><div className="results-layout"><div className="results-sidebar"><div className="results-sidebar-header"><h3>completed runs</h3><p className="sidebar-subtitle">{runs.length} run{runs.length !== 1 ? 's' : ''}</p></div><div className="results-list">{runs.length === 0 ? (<div className="empty-state-small"><p>no completed runs</p></div>) : runs.map(run => (<div key={run.id} className={`result-item ${selected?.id === run.id ? 'active' : ''}`} onClick={() => onSelect(run)}><div className="result-item-content"><h4>{run.id.substring(0, 8)}</h4><p className="result-item-dataset">üìä {run.dataset_name || run.dataset_id}</p><p className="result-item-algorithm">üîß {run.algorithm_name || run.algorithm_id}</p><p className="result-item-time">üïí {run.timestamp ? new Date(run.timestamp).toLocaleDateString() : 'n/a'}</p>{run.metrics && run.metrics.ate_rmse && (<p className="result-item-metric">ate: {run.metrics.ate_rmse.toFixed(4)}</p>)}</div></div>))}</div></div><div className="results-content">{!selected ? (<div className="empty-state"><div className="empty-icon">üìà</div><h3>select a run to view results</h3><p>choose a completed run from the sidebar to analyze metrics and visualizations</p></div>) : (<div className="result-details-view"><div className="result-header"><h2>run: {selected.id}</h2><div className="result-meta"><span className="meta-item">üìä dataset: {selected.dataset_name || selected.dataset_id}</span><span className="meta-item">üîß algorithm: {selected.algorithm_name || selected.algorithm_id}</span><span className="meta-item">üïí completed: {selected.timestamp ? new Date(selected.timestamp).toLocaleString() : 'n/a'}</span>{selected.duration && <span className="meta-item">‚è± duration: {selected.duration}s</span>}</div></div><div className="result-tabs"><button className={activeTab === 'metrics' ? 'active' : ''} onClick={() => setActiveTab('metrics')}>metrics</button><button className={activeTab === 'plots' ? 'active' : ''} onClick={() => setActiveTab('plots')}>plots</button><button className={activeTab === 'trajectory' ? 'active' : ''} onClick={() => setActiveTab('trajectory')}>trajectory</button><button className={activeTab === 'analysis' ? 'active' : ''} onClick={() => setActiveTab('analysis')}>analysis</button><button className={activeTab === 'raw' ? 'active' : ''} onClick={() => setActiveTab('raw')}>raw data</button></div><div className="result-content">{activeTab === 'metrics' && selected.metrics && (<div className="metrics-display"><div className="metrics-grid">{Object.entries(selected.metrics).map(([key, val]) => (<div key={key} className="metric-card"><h4>{key.replace(/_/g, ' ')}</h4><div className="metric-value">{typeof val === 'number' ? val.toFixed(4) : JSON.stringify(val)}</div></div>))}</div></div>)}{activeTab === 'plots' && (<div className="plots-display"><h3>visualization plots</h3>{selected.plots && selected.plots.length > 0 ? (<div className="plots-grid">{selected.plots.map((plot, idx) => (<div key={idx} className="plot-container"><h4>{plot.name || `plot ${idx + 1}`}</h4><img src={`${API}${plot.path}`} alt={plot.name} className="plot-image" /></div>))}</div>) : <p>no plots available</p>}</div>)}{activeTab === 'trajectory' && (<div className="trajectory-display"><h3>trajectory visualization</h3><div className="info-box"><p>3d trajectory viewer with interactive controls coming soon</p><p>features: rotation, zoom, pan, ground truth overlay, error heatmap</p></div></div>)}{activeTab === 'analysis' && (<div className="analysis-display"><h3>performance analysis</h3>{selected.robustness_score !== undefined && (<div className="analysis-card"><h4>robustness score</h4><div className="score-display"><div className="score-circle" style={{ background: `conic-gradient(#4f46e5 ${selected.robustness_score * 3.6}deg, #e5e7eb 0deg)` }}><span className="score-value">{selected.robustness_score.toFixed(1)}</span></div><p className="score-description">overall system reliability and error consistency (0-100 scale)</p></div></div>)}{selected.task_alignment_score !== undefined && (<div className="analysis-card"><h4>task alignment score</h4><div className="score-display"><div className="score-circle" style={{ background: `conic-gradient(#06b6d4 ${selected.task_alignment_score * 3.6}deg, #e5e7eb 0deg)` }}><span className="score-value">{selected.task_alignment_score.toFixed(1)}</span></div><p className="score-description">fitness-for-purpose metric for task-driven evaluation</p></div></div>)}{!selected.robustness_score && !selected.task_alignment_score && (<div className="info-box"><p>advanced analysis metrics not available for this run</p></div>)}</div>)}{activeTab === 'raw' && (<div className="raw-data-display"><h3>raw data</h3><pre className="code-block">{JSON.stringify(selected, null, 2)}</pre></div>)}</div></div>)}</div></div></div>);
}
function Compare({ runs, addNotification }) {
const [selectedRuns, setSelectedRuns] = useState([]);
const [comparison, setComparison] = useState(null);
const [loading, setLoading] = useState(false);
const toggleRun = (runId) => { if (selectedRuns.includes(runId)) { setSelectedRuns(selectedRuns.filter(id => id !== runId)); } else { if (selectedRuns.length < 10) { setSelectedRuns([...selectedRuns, runId]); } else { addNotification('maximum 10 runs for comparison', 'warning'); } } };
const handleCompare = async () => { if (selectedRuns.length < 2) { addNotification('select at least 2 runs to compare', 'error'); return; } setLoading(true); const res = await fetch(`${API}/api/compare`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ run_ids: selectedRuns }) }).then(r => r.json()).catch(() => null); setLoading(false); if (res) { setComparison(res); addNotification('comparison generated', 'success'); } else { addNotification('failed to generate comparison', 'error'); } };
return (<div className="compare-view"><div className="compare-header"><h2>run comparison</h2><p className="compare-description">select multiple runs to compare their performance metrics and generate statistical rankings</p></div><div className="compare-layout"><div className="compare-sidebar"><h3>select runs ({selectedRuns.length}/10)</h3><div className="compare-runs-list">{runs.length === 0 ? (<div className="empty-state-small"><p>no completed runs</p></div>) : runs.map(run => (<div key={run.id} className={`compare-run-item ${selectedRuns.includes(run.id) ? 'selected' : ''}`} onClick={() => toggleRun(run.id)}><input type="checkbox" checked={selectedRuns.includes(run.id)} onChange={() => toggleRun(run.id)} className="compare-checkbox" /><div className="compare-run-content"><h4>{run.id.substring(0, 8)}</h4><p>{run.algorithm_name || run.algorithm_id}</p><p className="run-dataset-small">{run.dataset_name || run.dataset_id}</p></div></div>))}</div><button className="btn btn-primary btn-large" onClick={handleCompare} disabled={loading || selectedRuns.length < 2}>{loading ? 'comparing...' : `compare ${selectedRuns.length} runs`}</button></div><div className="compare-content">{!comparison ? (<div className="empty-state"><div className="empty-icon">‚öñÔ∏è</div><h3>select runs to compare</h3><p>choose at least 2 completed runs from the sidebar to generate a statistical comparison</p></div>) : (<div className="comparison-results"><h3>comparison results</h3><div className="comparison-summary"><div className="summary-card"><h4>runs compared</h4><p className="summary-value">{comparison.total_runs}</p></div><div className="summary-card"><h4>metrics analyzed</h4><p className="summary-value">{comparison.metrics_count || Object.keys(comparison.statistics || {}).length}</p></div><div className="summary-card"><h4>best performer</h4><p className="summary-value">{comparison.rankings && comparison.rankings[0] ? comparison.rankings[0].run_id.substring(0, 8) : 'n/a'}</p></div></div>{comparison.statistics && Object.keys(comparison.statistics).length > 0 && (<div className="comparison-section"><h4>statistical summary</h4><div className="stats-table"><table className="comparison-table"><thead><tr><th>metric</th><th>mean</th><th>std dev</th><th>min</th><th>max</th></tr></thead><tbody>{Object.entries(comparison.statistics).map(([metric, stats]) => (<tr key={metric}><td>{metric.replace(/_/g, ' ')}</td><td>{stats.mean?.toFixed(4) || 'n/a'}</td><td>{stats.std?.toFixed(4) || 'n/a'}</td><td>{stats.min?.toFixed(4) || 'n/a'}</td><td>{stats.max?.toFixed(4) || 'n/a'}</td></tr>))}</tbody></table></div></div>)}{comparison.rankings && comparison.rankings.length > 0 && (<div className="comparison-section"><h4>performance rankings</h4><div className="rankings-list">{comparison.rankings.map((rank, idx) => { const run = runs.find(r => r.id === rank.run_id); return (<div key={rank.run_id} className="ranking-item"><div className="ranking-position"><span className="rank-number">{idx + 1}</span></div><div className="ranking-content"><h5>{run?.algorithm_name || run?.algorithm_id || rank.run_id.substring(0, 8)}</h5><p className="ranking-dataset">{run?.dataset_name || run?.dataset_id}</p><div className="ranking-score"><span className="score-label">composite score:</span><span className="score-value">{rank.score?.toFixed(4) || 'n/a'}</span></div></div></div>); })}</div></div>)}<div className="comparison-section"><h4>detailed comparison</h4><pre className="code-block">{JSON.stringify(comparison, null, 2)}</pre></div></div>)}</div></div></div>);
}
function Analytics({ runs, datasets, algorithms, stats, addNotification }) {
const completedRuns = runs.filter(r => r.status === 'completed');
const failedRuns = runs.filter(r => r.status === 'failed');
const runningRuns = runs.filter(r => r.status === 'running');
const successRate = runs.length > 0 ? ((completedRuns.length / runs.length) * 100).toFixed(1) : 0;
const failureRate = runs.length > 0 ? ((failedRuns.length / runs.length) * 100).toFixed(1) : 0;
const avgDuration = completedRuns.length > 0 ? (completedRuns.reduce((sum, r) => sum + (r.duration || 0), 0) / completedRuns.length).toFixed(2) : 0;
const topAlgorithm = completedRuns.length > 0 ? completedRuns.reduce((acc, run) => { const alg = run.algorithm_name || run.algorithm_id; acc[alg] = (acc[alg] || 0) + 1; return acc; }, {}) : {};
const mostUsedAlgorithm = Object.keys(topAlgorithm).length > 0 ? Object.entries(topAlgorithm).sort((a, b) => b[1] - a[1])[0][0] : 'n/a';
const topDataset = completedRuns.length > 0 ? completedRuns.reduce((acc, run) => { const ds = run.dataset_name || run.dataset_id; acc[ds] = (acc[ds] || 0) + 1; return acc; }, {}) : {};
const mostUsedDataset = Object.keys(topDataset).length > 0 ? Object.entries(topDataset).sort((a, b) => b[1] - a[1])[0][0] : 'n/a';
const avgRobustness = completedRuns.filter(r => r.robustness_score).length > 0 ? (completedRuns.filter(r => r.robustness_score).reduce((sum, r) => sum + r.robustness_score, 0) / completedRuns.filter(r => r.robustness_score).length).toFixed(2) : null;
const avgTaskAlignment = completedRuns.filter(r => r.task_alignment_score).length > 0 ? (completedRuns.filter(r => r.task_alignment_score).reduce((sum, r) => sum + r.task_alignment_score, 0) / completedRuns.filter(r => r.task_alignment_score).length).toFixed(2) : null;
return (<div className="analytics-view"><h2>platform analytics</h2><div className="analytics-grid"><div className="analytics-card"><div className="analytics-card-header"><h3>overview statistics</h3></div><div className="analytics-card-body"><div className="stat-grid"><div className="stat-box"><div className="stat-box-value">{stats.total_runs || runs.length}</div><div className="stat-box-label">total runs</div></div><div className="stat-box"><div className="stat-box-value">{stats.total_datasets || datasets.length}</div><div className="stat-box-label">datasets</div></div><div className="stat-box"><div className="stat-box-value">{stats.total_algorithms || algorithms.length}</div><div className="stat-box-label">algorithms</div></div><div className="stat-box"><div className="stat-box-value">{stats.success_rate || successRate}%</div><div className="stat-box-label">success rate</div></div></div></div></div><div className="analytics-card"><div className="analytics-card-header"><h3>performance metrics</h3></div><div className="analytics-card-body"><div className="stat-list"><div className="stat-row"><span className="stat-row-label">average duration</span><span className="stat-row-value">{avgDuration}s</span></div><div className="stat-row"><span className="stat-row-label">completed runs</span><span className="stat-row-value">{completedRuns.length}</span></div><div className="stat-row"><span className="stat-row-label">running runs</span><span className="stat-row-value">{runningRuns.length}</span></div><div className="stat-row"><span className="stat-row-label">failed runs</span><span className="stat-row-value">{failedRuns.length} ({failureRate}%)</span></div><div className="stat-row"><span className="stat-row-label">most used algorithm</span><span className="stat-row-value">{mostUsedAlgorithm}</span></div><div className="stat-row"><span className="stat-row-label">most used dataset</span><span className="stat-row-value">{mostUsedDataset}</span></div></div></div></div><div className="analytics-card"><div className="analytics-card-header"><h3>research metrics</h3></div><div className="analytics-card-body"><div className="stat-list">{avgRobustness && (<div className="stat-row"><span className="stat-row-label">avg robustness score</span><span className="stat-row-value">{avgRobustness}</span></div>)}{avgTaskAlignment && (<div className="stat-row"><span className="stat-row-label">avg task alignment</span><span className="stat-row-value">{avgTaskAlignment}</span></div>)}<div className="stat-row"><span className="stat-row-label">processed datasets</span><span className="stat-row-value">{datasets.filter(d => d.status === 'processed').length}</span></div><div className="stat-row"><span className="stat-row-label">custom algorithms</span><span className="stat-row-value">{algorithms.filter(a => a.type === 'custom').length}</span></div>{!avgRobustness && !avgTaskAlignment && (<div className="info-text">advanced research metrics available after running evaluations</div>)}</div></div></div><div className="analytics-card"><div className="analytics-card-header"><h3>recent activity</h3></div><div className="analytics-card-body"><div className="activity-list">{runs.slice(0, 10).map(run => (<div key={run.id} className="activity-item"><span className={`activity-icon ${run.status}`}>{run.status === 'completed' ? '‚úì' : run.status === 'failed' ? '‚úó' : run.status === 'running' ? '‚ñ∂Ô∏è' : '‚óã'}</span><div className="activity-content"><p className="activity-title">{run.algorithm_name || run.algorithm_id} on {run.dataset_name || run.dataset_id}</p><p className="activity-time">{run.timestamp ? new Date(run.timestamp).toLocaleString() : 'n/a'}</p></div></div>))}</div></div></div><div className="analytics-card analytics-card-wide"><div className="analytics-card-header"><h3>dataset distribution</h3></div><div className="analytics-card-body"><div className="distribution-grid">{datasets.reduce((acc, ds) => { const fmt = ds.format || 'unknown'; acc[fmt] = (acc[fmt] || 0) + 1; return acc; }, {}) && Object.entries(datasets.reduce((acc, ds) => { const fmt = ds.format || 'unknown'; acc[fmt] = (acc[fmt] || 0) + 1; return acc; }, {})).map(([format, count]) => (<div key={format} className="distribution-item"><div className="distribution-bar" style={{ width: `${(count / datasets.length) * 100}%` }}></div><div className="distribution-label">{format}: {count}</div></div>))}</div></div></div><div className="analytics-card analytics-card-wide"><div className="analytics-card-header"><h3>algorithm usage</h3></div><div className="analytics-card-body"><div className="distribution-grid">{Object.entries(topAlgorithm).map(([alg, count]) => (<div key={alg} className="distribution-item"><div className="distribution-bar" style={{ width: `${(count / completedRuns.length) * 100}%` }}></div><div className="distribution-label">{alg}: {count} runs</div></div>))}{Object.keys(topAlgorithm).length === 0 && (<div className="info-text">no completed runs yet</div>)}</div></div></div></div></div>);
}
function formatBytes(bytes) {
if (bytes === 0) return '0 B';
const k = 1024;
const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
const i = Math.floor(Math.log(bytes) / Math.log(k));
return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}
export default App;
